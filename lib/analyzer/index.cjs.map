{"version":3,"file":"index.cjs","sources":["../../src/analyzer/index.ts"],"sourcesContent":[null],"names":["canvasCache","contextCache","getCanvasContext","document","createElement","getContext","canvas","ctx","colorPool","MAX_POOL_SIZE","borrowColor","rgb","length","pop","Color","fromRGB","r","g","b","returnColor","color","push","window","addEventListener","ColorAnalyzer","extractPalette","input","count","_options","pixels","getImagePixels","kMeansClustering","sort","a","weight","map","cluster","center","findDominantColors","colorMap","Map","pixel","key","getColorKey","threshold","set","get","total","statistics","entries","split","Number","percentage","prominence","calculateProminence","slice","analyzeColorDistribution","hueDistribution","Array","from","saturationDistribution","lightnessDistribution","totalSaturation","totalLightness","hsl","toHSL","Math","round","h","s","l","maxHue","max","maxSat","maxLight","i","dominantHues","findPeaks","averageSaturation","averageLightness","img","loadImage","quality","sampleSize","width","min","height","drawImage","imageData","getImageData","data","len","ignoreWhite","ignoreBlack","clearRect","HTMLImageElement","Image","crossOrigin","src","url","URL","createObjectURL","onload","revokeObjectURL","Promise","resolve","reject","onerror","k","p","members","clusters","initializeCenters","c","maxIterations","iteration","changed","forEach","minDistance","Infinity","nearestCluster","distance","colorDistance","newCenter","calculateCentroid","filter","centers","first","floor","random","distances","minDist","dist","sum","reduce","j","totalR","totalG","totalB","c1","c2","rgb1","toRGB","rgb2","rMean","deltaR","deltaG","deltaB","weightR","weightG","weightB","sqrt","factor","saturationWeight","lightnessWeight","abs","peaks","index","value","generateColorReport","palette","dominant","distribution","all","mood","analyzeMood","temperature","analyzeTemperature","colors","avgSaturation","avgLightness","warmCount","coolCount","hue","bind"],"mappings":";;;;;;;;sCAmDA,IAAIA,EAAwC,KACxCC,EAAgD,KAEpD,SAASC,GAAgB,CACvB,OAAI,CAACF,GAAe,CAACC,KACnBD,EAAcG,SAASC,cAAc,QAAQ,EAC7CH,EAAeD,EAAYK,WAAW,IAAI,GAErC,CAAEC,OAAQN,EAAaO,IAAKN,CAAY,CACjD,CAGA,MAAMO,EAAqB,CAAA,EACrBC,EAAgB,GAEtB,SAASC,EAAYC,EAAQ,CAC3B,OAAIH,EAAUI,OAAS,GACrBJ,EAAUK,MAEHC,EAAAA,MAAMC,QAAQJ,EAAIK,EAAGL,EAAIM,EAAGN,EAAIO,CAAC,CAG5C,CAEA,SAASC,EAAYC,EAAY,CAC3BZ,EAAUI,OAASH,GACrBD,EAAUa,KAAKD,CAAK,CAExB,CAGI,OAAOE,OAAW,KACpBA,OAAOC,iBAAiB,SAAU,IAAK,CACrCf,EAAUI,OAAS,EACnBZ,EAAc,KACdC,EAAe,IACjB,CAAC,QAMUuB,CAAa,CAKxB,aAAaC,eACXC,EACAC,EAAQ,EACRC,EAA4B,CAAA,EAAE,CAE9B,MAAMC,EAAS,MAAM,KAAKC,eAAeJ,EAAOE,CAAQ,EAGxD,OAFiB,KAAKG,iBAAiBF,EAAQF,EAAOC,CAAQ,EAG3DI,KAAK,CAACC,EAAGf,IAAMA,EAAEgB,OAASD,EAAEC,MAAM,EAClCC,IAAIC,GAAWA,EAAQC,MAAM,CAClC,CAKA,aAAaC,mBACXZ,EACAC,EAAQ,EACRC,EAA4B,CAAA,EAAE,CAE9B,MAAMC,EAAS,MAAM,KAAKC,eAAeJ,EAAOE,CAAQ,EAClDW,EAAW,IAAIC,IAGrB,UAAWC,KAASZ,EAAQ,CAC1B,MAAMT,EAAQV,EAAY+B,CAAK,EACzBC,EAAM,KAAKC,YAAYvB,EAAOQ,EAASgB,WAAa,EAAE,EAC5DL,EAASM,IAAIH,GAAMH,EAASO,IAAIJ,CAAG,GAAK,GAAK,CAAC,EAC9CvB,EAAYC,CAAK,CACnB,CAGA,MAAM2B,EAAQlB,EAAOjB,OACfoC,EAAgC,CAAA,EAEtC,SAAW,CAACN,EAAKf,CAAK,IAAKY,EAASU,QAAAA,EAAW,CAC7C,KAAM,CAACjC,EAAGC,EAAGC,CAAC,EAAIwB,EAAIQ,MAAM,GAAG,EAAEf,IAAIgB,MAAM,EACrC/B,EAAQN,EAAAA,MAAMC,QAAQC,EAAGC,EAAGC,CAAC,EAC7BkC,EAAczB,EAAQoB,EAAS,IAC/BM,EAAa,KAAKC,oBAAoBlC,EAAOgC,CAAU,EAE7DJ,EAAW3B,KAAK,CACdD,MAAAA,EACAO,MAAAA,EACAyB,WAAAA,EACAC,WAAAA,CACD,CAAA,CACH,CAGA,OAAOL,EACJhB,KAAK,CAACC,EAAGf,IAAMA,EAAEmC,WAAapB,EAAEoB,UAAU,EAC1CE,MAAM,EAAG5B,CAAK,CACnB,CAKA,aAAa6B,yBACX9B,EACAE,EAA4B,CAAA,EAAE,CAE9B,MAAMC,EAAS,MAAM,KAAKC,eAAeJ,EAAOE,CAAQ,EAGlD6B,EAAkBC,MAAMC,KAAK,CAAC/C,OAAQ,KAAM,IAAM,CAAC,EACnDgD,EAAyBF,MAAMC,KAAK,CAAC/C,OAAQ,KAAM,IAAM,CAAC,EAC1DiD,EAAwBH,MAAMC,KAAK,CAAC/C,OAAQ,KAAM,IAAM,CAAC,EAE/D,IAAIkD,EAAkB,EAClBC,EAAiB,EAGrB,UAAWtB,KAASZ,EAAQ,CAC1B,MAAMT,EAAQV,EAAY+B,CAAK,EACzBuB,EAAM5C,EAAM6C,MAAAA,EAElBR,EAAgBS,KAAKC,MAAMH,EAAII,CAAC,CAAC,IACjCR,EAAuBM,KAAKC,MAAMH,EAAIK,CAAC,CAAC,IACxCR,EAAsBK,KAAKC,MAAMH,EAAIM,CAAC,CAAC,IAEvCR,GAAmBE,EAAIK,EACvBN,GAAkBC,EAAIM,EACtBnD,EAAYC,CAAK,CACnB,CAGA,MAAMmD,EAASL,KAAKM,IAAI,GAAGf,CAAe,EACpCgB,EAASP,KAAKM,IAAI,GAAGZ,CAAsB,EAC3Cc,EAAWR,KAAKM,IAAI,GAAGX,CAAqB,EAElD,QAASc,EAAI,EAAGA,EAAI,IAAKA,IACvBlB,EAAgBkB,CAAC,EAAIlB,EAAgBkB,CAAC,EAAIJ,EAE5C,QAASI,EAAI,EAAGA,EAAI,IAAKA,IACvBf,EAAuBe,CAAC,EAAIf,EAAuBe,CAAC,EAAIF,EACxDZ,EAAsBc,CAAC,EAAId,EAAsBc,CAAC,EAAID,EAIxD,MAAME,EAAe,KAAKC,UAAUpB,EAAiB,CAAC,EAEtD,MAAO,CACLA,gBAAAA,EACAG,uBAAAA,EACAC,sBAAAA,EACAe,aAAAA,EACAE,kBAAmBhB,EAAkBjC,EAAOjB,OAC5CmE,iBAAkBhB,EAAiBlC,EAAOjB,OAE9C,CAKQ,aAAakB,eACnBJ,EACAE,EAA4B,CAAA,EAAE,CAE9B,MAAMoD,EAAM,MAAM,KAAKC,UAAUvD,CAAK,EAChC,CAAEpB,OAAAA,EAAQC,IAAAA,GAAQL,EAAAA,EAGlBgF,EAAUtD,EAASsD,SAAW,EAC9BC,EAAavD,EAASuD,YAAcjB,KAAKM,IAAI,GAAI,IAAMU,EAAU,EAAE,EAEzE5E,EAAO8E,MAAQlB,KAAKmB,IAAIL,EAAII,MAAOD,CAAU,EAC7C7E,EAAOgF,OAASpB,KAAKmB,IAAIL,EAAIM,OAAQH,CAAU,EAE/C5E,EAAIgF,UAAUP,EAAK,EAAG,EAAG1E,EAAO8E,MAAO9E,EAAOgF,MAAM,EAEpD,MAAME,EAAYjF,EAAIkF,aAAa,EAAG,EAAGnF,EAAO8E,MAAO9E,EAAOgF,MAAM,EAC9DzD,EAAgB,CAAA,EAChB6D,EAAOF,EAAUE,KAGvB,QAASf,EAAI,EAAGgB,EAAMD,EAAK9E,OAAQ+D,EAAIgB,EAAKhB,GAAK,EAAG,CAIlD,GAHUe,EAAKf,EAAI,CAAC,EAGZ,IAAK,SAEb,MAAM3D,EAAI0E,EAAKf,CAAC,EACV1D,EAAIyE,EAAKf,EAAI,CAAC,EACdzD,EAAIwE,EAAKf,EAAI,CAAC,EAGhB/C,EAASgE,aAAe5E,EAAI,KAAOC,EAAI,KAAOC,EAAI,KAClDU,EAASiE,aAAe7E,EAAI,IAAMC,EAAI,IAAMC,EAAI,IAEpDW,EAAOR,KAAK,CAAEL,EAAAA,EAAGC,EAAAA,EAAGC,EAAAA,CAAC,CAAE,CACzB,CAGAX,OAAAA,EAAIuF,UAAU,EAAG,EAAGxF,EAAO8E,MAAO9E,EAAOgF,MAAM,EAExCzD,CACT,CAKQ,aAAaoD,UACnBvD,EAA8C,CAE9C,GAAIA,aAAiBqE,iBACnB,OAAOrE,EAGT,MAAMsD,EAAM,IAAIgB,MAGhB,GAFAhB,EAAIiB,YAAc,YAEd,OAAOvE,GAAU,SACnBsD,EAAIkB,IAAMxE,MACL,CACL,MAAMyE,EAAMC,IAAIC,gBAAgB3E,CAAK,EACrCsD,EAAIkB,IAAMC,EACVnB,EAAIsB,OAAS,IAAMF,IAAIG,gBAAgBJ,CAAG,CAC5C,CAEA,OAAO,IAAIK,QAAQ,CAACC,EAASC,IAAU,CACrC1B,EAAIsB,OAAS,IAAMG,EAAQzB,CAAG,EAC9BA,EAAI2B,QAAUD,CAChB,CAAC,CACH,CAKQ,OAAO3E,iBACbF,EACA+E,EACAhF,EAA4B,CAAA,EAAE,CAE9B,GAAIC,EAAOjB,SAAW,EAAG,MAAO,CAAA,EAChC,GAAIgG,GAAK/E,EAAOjB,OACd,OAAOiB,EAAOM,IAAI0E,IAAM,CACtBxE,OAAQ,IAAIvB,EAAAA,MAAM+F,CAAC,EACnBC,QAAS,CAACD,CAAC,EACX3E,OAAQ,CACT,EAAC,EAKJ,MAAM6E,EADU,KAAKC,kBAAkBnF,EAAQ+E,CAAC,EACPzE,IAAI8E,IAAM,CACjD5E,OAAQ4E,EACRH,QAAS,CAAA,EACT5E,OAAQ,CACT,EAAC,EAEIgF,EAAgB,GACtB,IAAIC,EAAY,EACZC,EAAU,GAEd,KAAOA,GAAWD,EAAYD,GAAe,CAC3CE,EAAU,GAGVL,EAASM,QAAQJ,GAAKA,EAAEH,QAAU,CAAA,CAAE,EAGpC,UAAWrE,KAASZ,EAAQ,CAC1B,MAAMT,EAAQV,EAAY+B,CAAK,EAC/B,IAAI6E,EAAcC,IACdC,EAAiB,EAErB,QAAS7C,EAAI,EAAGA,EAAIoC,EAASnG,OAAQ+D,IAAK,CACxC,MAAM8C,EAAW,KAAKC,cAActG,EAAO2F,EAASpC,CAAC,EAAEtC,MAAM,EACzDoF,EAAWH,IACbA,EAAcG,EACdD,EAAiB7C,EAErB,CAEAoC,EAASS,CAAc,EAAEV,QAAQzF,KAAKoB,CAAK,EAC3CtB,EAAYC,CAAK,CACnB,CAGA,UAAWgB,KAAW2E,EACpB,GAAI3E,EAAQ0E,QAAQlG,OAAS,EAAG,CAC9B,MAAM+G,EAAY,KAAKC,kBAAkBxF,EAAQ0E,OAAO,EACpD,KAAKY,cAAcC,EAAWvF,EAAQC,MAAM,EAAI,IAClDD,EAAQC,OAASsF,EACjBP,EAAU,IAEZhF,EAAQF,OAASE,EAAQ0E,QAAQlG,OAASiB,EAAOjB,MACnD,CAGFuG,GACF,CAEA,OAAOJ,EAASc,OAAOZ,GAAKA,EAAEH,QAAQlG,OAAS,CAAC,CAClD,CAKQ,OAAOoG,kBAAkBnF,EAAe+E,EAAS,CACvD,MAAMkB,EAAmB,CAAA,EAGnBC,EAAQlG,EAAOqC,KAAK8D,MAAM9D,KAAK+D,OAAAA,EAAWpG,EAAOjB,MAAM,CAAC,EAC9DkH,EAAQzG,KAAK,IAAIP,EAAAA,MAAMiH,CAAK,CAAC,EAG7B,QAASpD,EAAI,EAAGA,EAAIiC,EAAGjC,IAAK,CAC1B,MAAMuD,EAAYrG,EAAOM,IAAIM,GAAQ,CACnC,MAAMrB,EAAQV,EAAY+B,CAAK,EAC/B,IAAI0F,EAAUZ,IACd,UAAWlF,KAAUyF,EAAS,CAC5B,MAAMM,EAAO,KAAKV,cAActG,EAAOiB,CAAM,EACzC+F,EAAOD,IAASA,EAAUC,EAChC,CACAjH,OAAAA,EAAYC,CAAK,EACV+G,CACT,CAAC,EAGKE,EAAMH,EAAUI,OAAO,CAACrG,EAAGf,IAAMe,EAAIf,EAAG,CAAC,EAC/C,IAAI+G,EAAS/D,KAAK+D,OAAAA,EAAWI,EAE7B,QAASE,EAAI,EAAGA,EAAI1G,EAAOjB,OAAQ2H,IAEjC,GADAN,GAAUC,EAAUK,CAAC,EACjBN,GAAU,EAAG,CACfH,EAAQzG,KAAK,IAAIP,EAAAA,MAAMe,EAAO0G,CAAC,CAAC,CAAC,EACjC,KACF,CAEJ,CAEA,OAAOT,CACT,CAKQ,OAAOF,kBAAkB/F,EAAa,CAC5C,GAAIA,EAAOjB,SAAW,EAAG,OAAO,IAAIE,EAAAA,MAAM,SAAS,EAEnD,IAAI0H,EAAS,EAAOC,EAAS,EAAOC,EAAS,EAE7C,UAAWjG,KAASZ,EAClB2G,GAAU/F,EAAMzB,EAChByH,GAAUhG,EAAMxB,EAChByH,GAAUjG,EAAMvB,EAGlB,MAAMS,EAAQE,EAAOjB,OACrB,OAAOE,EAAAA,MAAMC,QACXmD,KAAKC,MAAMqE,EAAS7G,CAAK,EACzBuC,KAAKC,MAAMsE,EAAS9G,CAAK,EACzBuC,KAAKC,MAAMuE,EAAS/G,CAAK,CAAC,CAE9B,CAKQ,OAAO+F,cAAciB,EAAWC,EAAS,CAC/C,MAAMC,EAAOF,EAAGG,MAAAA,EACVC,EAAOH,EAAGE,MAAAA,EAGVE,GAASH,EAAK7H,EAAI+H,EAAK/H,GAAK,EAC5BiI,EAASJ,EAAK7H,EAAI+H,EAAK/H,EACvBkI,EAASL,EAAK5H,EAAI8H,EAAK9H,EACvBkI,EAASN,EAAK3H,EAAI6H,EAAK7H,EAEvBkI,EAAU,EAAIJ,EAAQ,IACtBK,EAAU,EACVC,EAAU,GAAK,IAAMN,GAAS,IAEpC,OAAO9E,KAAKqF,KACVH,EAAUH,EAASA,EACnBI,EAAUH,EAASA,EACnBI,EAAUH,EAASA,CAAM,CAE7B,CAKQ,OAAOxG,YAAYvB,EAAcwB,EAAiB,CACxD,MAAMjC,EAAMS,EAAM0H,MAAAA,EACZU,EAAStF,KAAKM,IAAI,EAAG5B,CAAS,EAE9B5B,EAAIkD,KAAKC,MAAMxD,EAAIK,EAAIwI,CAAM,EAAIA,EACjCvI,EAAIiD,KAAKC,MAAMxD,EAAIM,EAAIuI,CAAM,EAAIA,EACjCtI,EAAIgD,KAAKC,MAAMxD,EAAIO,EAAIsI,CAAM,EAAIA,EAEvC,MAAO,GAAGxI,CAAC,IAAIC,CAAC,IAAIC,CAAC,EACvB,CAKQ,OAAOoC,oBAAoBlC,EAAcgC,EAAkB,CACjE,MAAMY,EAAM5C,EAAM6C,MAAAA,EAGZwF,EAAmBzF,EAAIK,EAAI,IAC3BqF,EAAkB,EAAIxF,KAAKyF,IAAI3F,EAAIM,EAAI,EAAE,EAAI,GAEnD,OAAOlB,EAAaqG,EAAmBC,CACzC,CAKQ,OAAO7E,UAAUa,EAAgB/D,EAAa,CACpD,MAAMiI,EAA4C,CAAA,EAElD,QAASjF,EAAI,EAAGA,EAAIe,EAAK9E,OAAS,EAAG+D,IAC/Be,EAAKf,CAAC,EAAIe,EAAKf,EAAI,CAAC,GAAKe,EAAKf,CAAC,EAAIe,EAAKf,EAAI,CAAC,GAC/CiF,EAAMvI,KAAK,CAAEwI,MAAOlF,EAAGmF,MAAOpE,EAAKf,CAAC,CAAC,CAAE,EAI3C,OAAOiF,EACJ5H,KAAK,CAACC,EAAGf,IAAMA,EAAE4I,MAAQ7H,EAAE6H,KAAK,EAChCvG,MAAM,EAAG5B,CAAK,EACdQ,IAAI0E,GAAKA,EAAEgD,KAAK,CACrB,CAKA,aAAaE,oBACXrI,EACAE,EAA4B,CAAA,EAAE,CAQ9B,KAAM,CAACoI,EAASC,EAAUC,CAAY,EAAI,MAAM1D,QAAQ2D,IAAI,CAC1D,KAAK1I,eAAeC,EAAO,EAAGE,CAAQ,EACtC,KAAKU,mBAAmBZ,EAAO,EAAGE,CAAQ,EAC1C,KAAK4B,yBAAyB9B,EAAOE,CAAQ,CAAC,CAC/C,EAGKwI,EAAO,KAAKC,YAAYL,CAAO,EAG/BM,EAAc,KAAKC,mBAAmBL,EAAatF,YAAY,EAErE,MAAO,CACLoF,QAAAA,EACAC,SAAAA,EACAC,aAAAA,EACAE,KAAAA,EACAE,YAAAA,EAEJ,CAKQ,OAAOD,YAAYG,EAAe,CACxC,IAAI1G,EAAkB,EAClBC,EAAiB,EAErB,UAAW3C,KAASoJ,EAAQ,CAC1B,MAAMxG,EAAM5C,EAAM6C,QAClBH,GAAmBE,EAAIK,EACvBN,GAAkBC,EAAIM,CACxB,CAEA,MAAMmG,EAAgB3G,EAAkB0G,EAAO5J,OACzC8J,EAAe3G,EAAiByG,EAAO5J,OAE7C,OAAI6J,EAAgB,IAAMC,EAAe,GAChC,uCACED,EAAgB,IAAMC,EAAe,GACvC,uCACEA,EAAe,GACjB,uCACED,EAAgB,GAClB,uCAEA,sCAEX,CAKQ,OAAOF,mBAAmB3F,EAAsB,CACtD,GAAIA,EAAahE,SAAW,EAAG,MAAO,UAEtC,IAAI+J,EAAY,EACZC,EAAY,EAEhB,UAAWC,KAAOjG,EACZiG,GAAO,GAAKA,GAAO,IAAMA,GAAO,KAAOA,GAAO,IAChDF,IACSE,GAAO,KAAOA,GAAO,KAC9BD,IAIJ,OAAID,EAAYC,EAAkB,OAC9BA,EAAYD,EAAkB,OAC3B,SACT,CACD,OAGYlJ,EAAiBD,EAAcC,eAAeqJ,KAAKtJ,CAAa,EAChEc,EAAqBd,EAAcc,mBAAmBwI,KAAKtJ,CAAa,EACxEgC,EAA2BhC,EAAcgC,yBAAyBsH,KAAKtJ,CAAa,EACpFuI,EAAsBvI,EAAcuI,oBAAoBe,KAAKtJ,CAAa"}