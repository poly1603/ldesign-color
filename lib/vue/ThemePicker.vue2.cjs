"use strict";/*!
 * ***********************************
 * @ldesign/color v1.0.0           *
 * Built with rollup               *
 * Build time: 2024-10-21 14:32:31 *
 * Build mode: production          *
 * Minified: No                    *
 * ***********************************
 */Object.defineProperty(exports,"__esModule",{value:!0});var e=require("vue"),Y=require("../locales/index.cjs"),Z=require("../plugin/index.cjs"),G=require("./useTheme.cjs");const J=["title"],Q=["stroke"],ee=["fill"],te=["fill"],le=["fill"],oe=["fill"],ae={key:0,class:"ld-theme-picker__search"},re=["placeholder"],ce={class:"ld-theme-picker__content"},ne={key:0,class:"ld-theme-picker__custom"},ie={class:"ld-theme-picker__label"},ue={class:"ld-theme-picker__custom-input"},se={key:0,class:"ld-theme-picker__add-theme"},me={class:"ld-theme-picker__label"},de={class:"ld-theme-picker__add-input"},pe=["placeholder"],he=["disabled"],ve={class:"ld-theme-picker__presets"},fe={class:"ld-theme-picker__label"},ke={style:{"font-size":"10px",color:"#999","margin-left":"8px"}},ye={class:"ld-theme-picker__grid"},we=["title","onClick"],Ce={key:0,class:"ld-theme-picker__check",width:"16",height:"16",viewBox:"0 0 16 16"},_e=["onClick"],Ee=["title","onClick"];var Ve=e.defineComponent({__name:"ThemePicker",props:{modelValue:{type:String,required:!1},showArrow:{type:Boolean,required:!1,default:!0},showSearch:{type:Boolean,required:!1,default:!1},showCustom:{type:Boolean,required:!1,default:!1},showAddCustomTheme:{type:Boolean,required:!1,default:!1},showRemoveButton:{type:Boolean,required:!1,default:!0},prefix:{type:String,required:!1,default:"ld"},storageKey:{type:String,required:!1}},emits:["update:modelValue","change"],setup(A,{emit:z}){const k=A,y=z,a=e.inject(Z.ColorPluginSymbol,void 0),T=e.inject("locale",null),B=e.computed(()=>a?.currentLocale?.value?a.currentLocale.value:T&&T.value?T.value:"zh-CN"),$=e.computed(()=>Y.getLocale(B.value)),c=(t,l)=>{const o=t.split(".");let r=$.value;for(const m of o)if(r&&typeof r=="object")r=r[m];else return l||t;return typeof r=="string"?r:l||t},w=e.ref(),u=e.ref(!1),C=e.ref(""),i=e.ref("#1890ff"),p=e.ref(""),s=e.ref("#1890ff"),b=e.ref({}),d=e.ref(""),{presets:U,primaryColor:L,themeName:h,applyTheme:S,applyPresetTheme:P,restoreTheme:K}=G.useTheme({prefix:k.prefix,storageKey:k.storageKey}),D=e.computed(()=>a?a.getSortedPresets():U.value),_=e.computed(()=>k.modelValue||L.value||"#1890ff"),v=e.computed(()=>{const t=_.value,l=Number.parseInt(t.slice(1,3),16),o=Number.parseInt(t.slice(3,5),16),r=Number.parseInt(t.slice(5,7),16);return(l*299+o*587+r*114)/1e3>128?"#595959":t}),R=e.computed(()=>{const t=d.value||h.value,l=D.value.find(o=>o.name===t);if(l){const o=`theme.presets.${l.name}`;return c(o,l.label)}return c("theme.title","Theme Color")}),E=e.computed(()=>d.value||h.value),j=e.computed(()=>{const t=[...D.value];return!t.some(l=>l.color.toLowerCase()===(_.value||"").toLowerCase())&&_.value&&t.unshift({name:"custom-current",label:c("theme.custom","Current Color"),color:_.value,custom:!0}),t}),I=e.computed(()=>{let t=j.value;if(C.value){const l=C.value.toLowerCase();t=t.filter(o=>o.label.toLowerCase().includes(l)||o.name.toLowerCase().includes(l)||o.color.toLowerCase().includes(l))}return[...t].sort((l,o)=>{const r=l.order??9999,m=o.order??9999;return r-m})}),F=()=>{if(!w.value)return;const t=w.value.getBoundingClientRect(),l=360,o=window.innerWidth,r=window.innerHeight,m=296,n=16,q=r-t.bottom-n,X=t.top-n;let N=t.bottom+n;q<l&&X>q&&(N=t.top-l-n),N=Math.max(n,Math.min(N,r-l-n));let f=t.left+t.width/2-m/2;f<n?f=n:f+m>o-n&&(f=o-m-n),b.value={position:"fixed",top:`${N}px`,left:`${f}px`,width:`${m}px`,maxWidth:`calc(100vw - ${n*2}px)`,zIndex:9999}},H=()=>{u.value=!u.value,u.value&&e.nextTick(()=>F())},g=async t=>{try{d.value=t.name,a?await a.applyPresetTheme(t.name):await P(t.name),y("update:modelValue",t.color),y("change",t.color,t)}catch(l){console.error("[ThemePicker] Failed to apply preset theme:",l),d.value=h.value}u.value=!1},x=async()=>{if(i.value){try{a?await a.applyTheme(i.value):await S(i.value),y("update:modelValue",i.value),y("change",i.value)}catch(t){console.error("[ThemePicker] Failed to apply custom color:",t)}u.value=!1}},W=async()=>{if(!p.value||!s.value)return;const t=p.value,l=s.value;try{a&&typeof a.addCustomTheme=="function"?(a.addCustomTheme({name:t,label:t,color:l,custom:!0}),p.value="",s.value="#1890ff",await g({name:t,label:t,color:l,custom:!0})):console.warn("[ThemePicker] Color plugin not found. Cannot add custom theme.")}catch(o){console.error("[ThemePicker] Failed to add custom theme:",o),console.error("[ThemePicker] Failed to add custom theme:",o instanceof Error?o.message:"Failed to add theme")}},O=async t=>{try{a&&typeof a.removeCustomTheme=="function"?(a.removeCustomTheme(t),h.value===t&&(a.applyPresetTheme?await a.applyPresetTheme("blue"):await P("blue"))):console.warn("[ThemePicker] Color plugin not found. Cannot remove custom theme.")}catch(l){console.error("[ThemePicker] Failed to remove custom theme:",l),console.error("[ThemePicker] Failed to remove theme:",l instanceof Error?l.message:"Failed to remove theme")}},M=t=>{w.value?.contains(t.target)||(u.value=!1)},V=()=>{u.value&&F()};return e.onMounted(()=>{K(),d.value=h.value,document.addEventListener("click",M),window.addEventListener("resize",V),window.addEventListener("scroll",V)}),e.onUnmounted(()=>{document.removeEventListener("click",M),window.removeEventListener("resize",V),window.removeEventListener("scroll",V)}),e.watch(()=>k.modelValue,t=>{t&&t!==L.value&&S(t)}),e.watch(h,t=>{t&&t!==d.value&&(d.value=t)}),(t,l)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"pickerRef",ref:w,class:"ld-theme-picker"},[e.createElementVNode("button",{class:"ld-theme-picker__trigger",title:R.value,onClick:H},[(e.openBlock(),e.createElementBlock("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:v.value,"stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e.createElementVNode("circle",{cx:"13.5",cy:"6.5",r:".5",fill:v.value},null,8,ee),e.createElementVNode("circle",{cx:"17.5",cy:"10.5",r:".5",fill:v.value},null,8,te),e.createElementVNode("circle",{cx:"8.5",cy:"7.5",r:".5",fill:v.value},null,8,le),e.createElementVNode("circle",{cx:"6.5",cy:"12.5",r:".5",fill:v.value},null,8,oe),l[7]||(l[7]=e.createElementVNode("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"},null,-1))],8,Q))],8,J),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createVNode(e.Transition,{name:"ld-theme-picker-fade"},{default:e.withCtx(()=>[u.value?(e.openBlock(),e.createElementBlock("div",{key:0,class:"ld-theme-picker__dropdown",style:e.normalizeStyle(b.value),onClick:l[6]||(l[6]=e.withModifiers(()=>{},["stop"]))},[t.showSearch?(e.openBlock(),e.createElementBlock("div",ae,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":l[0]||(l[0]=o=>C.value=o),type:"text",placeholder:c("theme.searchPlaceholder","Search colors..."),class:"ld-theme-picker__search-input"},null,8,re),[[e.vModelText,C.value]])])):e.createCommentVNode("v-if",!0),e.createElementVNode("div",ce,[t.showCustom?(e.openBlock(),e.createElementBlock("div",ne,[e.createElementVNode("label",ie,e.toDisplayString(c("theme.customColor","Custom Color")),1),e.createElementVNode("div",ue,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":l[1]||(l[1]=o=>i.value=o),type:"color",class:"ld-theme-picker__color-input",onChange:x},null,544),[[e.vModelText,i.value]]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":l[2]||(l[2]=o=>i.value=o),type:"text",placeholder:"#000000",class:"ld-theme-picker__hex-input",onKeyup:e.withKeys(x,["enter"])},null,544),[[e.vModelText,i.value]]),e.createElementVNode("button",{class:"ld-theme-picker__apply-btn",onClick:x},e.toDisplayString(c("theme.apply","Apply")),1)]),e.createCommentVNode(" \u6DFB\u52A0\u81EA\u5B9A\u4E49\u4E3B\u9898 "),t.showAddCustomTheme?(e.openBlock(),e.createElementBlock("div",se,[e.createElementVNode("label",me,e.toDisplayString(c("theme.addCustomTheme","Add Custom Theme")),1),e.createElementVNode("div",de,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":l[3]||(l[3]=o=>p.value=o),type:"text",placeholder:c("theme.themeName","Theme name"),class:"ld-theme-picker__name-input"},null,8,pe),[[e.vModelText,p.value]]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":l[4]||(l[4]=o=>s.value=o),type:"color",class:"ld-theme-picker__color-input"},null,512),[[e.vModelText,s.value]]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":l[5]||(l[5]=o=>s.value=o),type:"text",placeholder:"#000000",class:"ld-theme-picker__hex-input"},null,512),[[e.vModelText,s.value]]),e.createElementVNode("button",{class:"ld-theme-picker__add-btn",disabled:!p.value||!s.value,onClick:W},e.toDisplayString(c("theme.add","Add")),9,he)])])):e.createCommentVNode("v-if",!0)])):e.createCommentVNode("v-if",!0),e.createElementVNode("div",ve,[e.createElementVNode("label",fe,[e.createTextVNode(e.toDisplayString(c("theme.selectThemeColor","Select Theme Color"))+" ",1),e.createElementVNode("span",ke," ("+e.toDisplayString(B.value)+") ",1)]),e.createElementVNode("div",ye,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(I.value,o=>(e.openBlock(),e.createElementBlock("div",{key:`${o.name}-${o.color}`,class:e.normalizeClass(["ld-theme-picker__preset",{"is-active":o.name===E.value||!E.value&&o.custom,"is-custom":o.custom}])},[e.createElementVNode("span",{class:"ld-theme-picker__preset-color",style:e.normalizeStyle({backgroundColor:o.color}),title:o.label,onClick:r=>g(o)},[o.name===E.value||!E.value&&o.custom?(e.openBlock(),e.createElementBlock("svg",Ce,[...l[8]||(l[8]=[e.createElementVNode("path",{d:"M3 8L6 11L13 4",stroke:"white","stroke-width":"2",fill:"none"},null,-1)])])):e.createCommentVNode("v-if",!0)],12,we),e.createElementVNode("span",{class:"ld-theme-picker__preset-label",onClick:r=>g(o)},e.toDisplayString(c(`theme.presets.${o.name}`,o.label)),9,_e),e.createCommentVNode(" \u5220\u9664\u6309\u94AE\uFF08\u4EC5\u81EA\u5B9A\u4E49\u4E3B\u9898\uFF09 "),o.custom&&t.showRemoveButton?(e.openBlock(),e.createElementBlock("button",{key:0,class:"ld-theme-picker__remove-btn",title:c("theme.remove","Remove"),onClick:e.withModifiers(r=>O(o.name),["stop"])}," \xD7 ",8,Ee)):e.createCommentVNode("v-if",!0)],2))),128))])])])],4)):e.createCommentVNode("v-if",!0)]),_:1})]))],512))}});exports.default=Ve;/*! End of @ldesign/color | Powered by @ldesign/builder */
//# sourceMappingURL=ThemePicker.vue2.cjs.map
