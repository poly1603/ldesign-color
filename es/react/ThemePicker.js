/*!
 * ***********************************
 * @ldesign/color v1.0.0           *
 * Built with rollup               *
 * Build time: 2024-10-21 14:32:31 *
 * Build mode: production          *
 * Minified: No                    *
 * ***********************************
 */import{createVNode as t,createTextVNode as b}from"vue";import{useRef as F,useState as w,useMemo as f,useCallback as s,useEffect as T}from"react";import{useTheme as G}from"./useTheme.js";const J=({value:a,onChange:i,showArrow:K=!0,showSearch:P=!1,showCustom:z=!1,prefix:U="ld",storageKey:V})=>{const c=F(null),[m,u]=w(!1),[d,W]=w(""),[o,x]=w("#1890ff"),[q,H]=w({}),{presets:p,primaryColor:h,themeName:r,applyTheme:k,applyPresetTheme:E,restoreTheme:I}=G({prefix:U,storageKey:V}),n=f(()=>a||h||"#1890ff",[a,h]),R=f(()=>p.find(e=>e.name===r)?.label||"\u4E3B\u9898\u8272",[p,r]),g=f(()=>{const e=[...p];return e.some(l=>l.color.toLowerCase()===(n||"").toLowerCase())||e.unshift({name:"custom",label:"\u81EA\u5B9A\u4E49",color:n,custom:!0}),e},[p,n]),S=f(()=>{if(!d)return g;const e=d.toLowerCase();return g.filter(l=>l.label.toLowerCase().includes(e)||l.name.toLowerCase().includes(e)||l.color.toLowerCase().includes(e))},[g,d]),_=s(()=>{if(!c.current)return;const e=c.current.getBoundingClientRect(),l=400,M=window.innerWidth,A=window.innerHeight,B=Math.min(320,Math.max(240,M-16)),$=A-e.bottom,O=e.top;let C=e.bottom+4;$<l&&O>$&&(C=e.top-l-4),C=Math.max(8,Math.min(C,A-8-l));let N=e.left;const Q=M-8-B;N=Math.max(8,Math.min(N,Math.max(8,Q))),H({position:"fixed",top:`${C}px`,left:`${N}px`,width:`${B}px`,zIndex:9999})},[]),j=s(()=>{u(e=>(e||queueMicrotask(()=>_()),!e))},[_]),D=s(e=>{E(e.name),i?.(e.color,e),u(!1)},[E,i]),y=s(()=>{o&&(k(o),i?.(o),u(!1))},[o,k,i]),L=s(e=>{c.current?.contains(e.target)||u(!1)},[]),v=s(()=>{m&&_()},[m,_]);return T(()=>(I(),document.addEventListener("click",L),window.addEventListener("resize",v),window.addEventListener("scroll",v),()=>{document.removeEventListener("click",L),window.removeEventListener("resize",v),window.removeEventListener("scroll",v)}),[]),T(()=>{a&&a!==h&&k(a)},[a,h,k]),t("div",{className:"ld-theme-picker",ref:c},[t("button",{className:"ld-theme-picker__trigger",onClick:j,style:{backgroundColor:n},title:R},[t("span",{className:"ld-theme-picker__color",style:{backgroundColor:n}},null,4),K&&t("svg",{className:`ld-theme-picker__arrow ${m?"is-open":""}`,width:"12",height:"12",viewBox:"0 0 12 12"},[t("path",{d:"M2.5 4.5L6 8L9.5 4.5",stroke:"currentColor",strokeWidth:"1.5",fill:"none"},null)],8,["className"])],12,["onClick","title"]),m&&t("div",{className:"ld-theme-picker__dropdown",style:q,onClick:e=>e.stopPropagation()},[P&&t("div",{className:"ld-theme-picker__search"},[t("input",{value:d,onChange:e=>W(e.target.value),type:"text",placeholder:"\u641C\u7D22\u989C\u8272...",className:"ld-theme-picker__search-input"},null,40,["value","onChange"])]),t("div",{className:"ld-theme-picker__content"},[z&&t("div",{className:"ld-theme-picker__custom"},[t("label",{className:"ld-theme-picker__label"},[b("\u81EA\u5B9A\u4E49\u989C\u8272")]),t("div",{className:"ld-theme-picker__custom-input"},[t("input",{value:o,onChange:e=>x(e.target.value),type:"color",className:"ld-theme-picker__color-input"},null,40,["value","onChange"]),t("input",{value:o,onChange:e=>x(e.target.value),onKeyUp:e=>e.key==="Enter"&&y(),type:"text",placeholder:"#000000",className:"ld-theme-picker__hex-input"},null,40,["value","onChange","onKeyUp"]),t("button",{className:"ld-theme-picker__apply-btn",onClick:y},[b("\u5E94\u7528")],8,["onClick"])])]),t("div",{className:"ld-theme-picker__presets"},[t("label",{className:"ld-theme-picker__label"},[b("\u9009\u62E9\u4E3B\u9898\u8272")]),t("div",{className:"ld-theme-picker__grid"},[S.map(e=>t("div",{key:`${e.name}-${e.color}`,className:`ld-theme-picker__preset ${e.name===r||!r&&e.custom?"is-active":""}`,onClick:()=>D(e)},[t("span",{className:"ld-theme-picker__preset-color",style:{backgroundColor:e.color},title:e.label},[(e.name===r||!r&&e.custom)&&t("svg",{className:"ld-theme-picker__check",width:"16",height:"16",viewBox:"0 0 16 16"},[t("path",{d:"M3 8L6 11L13 4",stroke:"white",strokeWidth:"2",fill:"none"},null)])],12,["title"]),t("span",{className:"ld-theme-picker__preset-label"},[e.custom?"\u81EA\u5B9A\u4E49":e.label])],8,["className","onClick"]))])])])],12,["onClick"])],512)};/*! End of @ldesign/color | Powered by @ldesign/builder */export{J as ThemePicker};
//# sourceMappingURL=ThemePicker.js.map
