<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>无障碍检查器 - @ldesign/color</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      padding: 40px 20px;
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      min-height: 100vh;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      padding: 40px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    h1 {
      text-align: center;
      color: #333;
      margin-bottom: 10px;
      font-size: 2.5rem;
    }

    .subtitle {
      text-align: center;
      color: #666;
      margin-bottom: 40px;
    }

    .color-inputs {
      display: flex;
      gap: 30px;
      justify-content: center;
      margin-bottom: 40px;
      flex-wrap: wrap;
    }

    .color-input-group {
      text-align: center;
    }

    .color-input-group label {
      display: block;
      font-weight: 600;
      color: #555;
      margin-bottom: 10px;
    }

    input[type="color"] {
      width: 120px;
      height: 120px;
      border: 4px solid #e0e0e0;
      border-radius: 15px;
      cursor: pointer;
      margin-bottom: 10px;
    }

    input[type="text"] {
      width: 120px;
      padding: 8px 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      text-align: center;
      font-family: 'Courier New', monospace;
      font-size: 14px;
    }

    .preview-section {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 40px;
    }

    .preview-card {
      border-radius: 12px;
      padding: 40px;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s;
    }

    .preview-card:hover {
      transform: translateY(-5px);
    }

    .preview-text {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 15px;
    }

    .preview-small {
      font-size: 14px;
    }

    .results-section {
      background: #f8f9fa;
      padding: 30px;
      border-radius: 12px;
      margin-bottom: 30px;
    }

    .results-title {
      font-size: 20px;
      font-weight: 600;
      color: #333;
      margin-bottom: 20px;
      text-align: center;
    }

    .result-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 25px;
    }

    .result-item {
      background: white;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    .result-label {
      font-size: 13px;
      color: #888;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .result-value {
      font-size: 28px;
      font-weight: 700;
      color: #333;
    }

    .result-value.pass {
      color: #27ae60;
    }

    .result-value.fail {
      color: #e74c3c;
    }

    .wcag-levels {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
    }

    .wcag-level {
      background: white;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      border: 3px solid transparent;
    }

    .wcag-level.pass {
      border-color: #27ae60;
      background: #e8f8f5;
    }

    .wcag-level.fail {
      border-color: #e74c3c;
      background: #fadbd8;
    }

    .wcag-level-name {
      font-weight: 600;
      font-size: 16px;
      margin-bottom: 5px;
    }

    .wcag-level-status {
      font-size: 24px;
    }

    .wcag-level-desc {
      font-size: 11px;
      color: #666;
      margin-top: 5px;
    }

    .suggestions {
      background: white;
      padding: 25px;
      border-radius: 12px;
      margin-top: 20px;
    }

    .suggestion-item {
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
      margin-bottom: 12px;
      border-left: 4px solid #4facfe;
    }

    .suggestion-item:last-child {
      margin-bottom: 0;
    }

    @media (max-width: 768px) {
      .preview-section {
        grid-template-columns: 1fr;
      }

      .result-grid,
      .wcag-levels {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>♿ 无障碍检查器</h1>
    <p class="subtitle">检查颜色组合的 WCAG 对比度合规性</p>

    <div class="color-inputs">
      <div class="color-input-group">
        <label>背景颜色</label>
        <input type="color" id="bgColor" value="#ffffff">
        <input type="text" id="bgHex" value="#ffffff">
      </div>
      <div class="color-input-group">
        <label>文本颜色</label>
        <input type="color" id="textColor" value="#333333">
        <input type="text" id="textHex" value="#333333">
      </div>
    </div>

    <div class="preview-section">
      <div class="preview-card" id="normalPreview">
        <div class="preview-text">正常文本</div>
        <div class="preview-small">这是小号文本示例</div>
      </div>
      <div class="preview-card" id="largePreview">
        <div class="preview-text">大号文本</div>
        <div class="preview-small">这是小号文本示例</div>
      </div>
    </div>

    <div class="results-section">
      <div class="results-title">对比度分析</div>
      <div class="result-grid">
        <div class="result-item">
          <div class="result-label">对比度</div>
          <div class="result-value" id="contrastRatio">-</div>
        </div>
        <div class="result-item">
          <div class="result-label">文本亮度</div>
          <div class="result-value" id="textLuminance">-</div>
        </div>
        <div class="result-item">
          <div class="result-label">背景亮度</div>
          <div class="result-value" id="bgLuminance">-</div>
        </div>
      </div>

      <div class="results-title" style="margin-top: 30px;">WCAG 合规性</div>
      <div class="wcag-levels" id="wcagLevels"></div>

      <div class="suggestions" id="suggestions"></div>
    </div>
  </div>

  <script type="module">
    import { Color } from '../es/index.js'

    const bgColorInput = document.getElementById('bgColor')
    const textColorInput = document.getElementById('textColor')
    const bgHexInput = document.getElementById('bgHex')
    const textHexInput = document.getElementById('textHex')

    function updateAccessibility() {
      const bgColor = new Color(bgColorInput.value)
      const textColor = new Color(textColorInput.value)

      // 更新预览
      const normalPreview = document.getElementById('normalPreview')
      const largePreview = document.getElementById('largePreview')
      normalPreview.style.background = bgColor.toHex()
      normalPreview.style.color = textColor.toHex()
      largePreview.style.background = bgColor.toHex()
      largePreview.style.color = textColor.toHex()

      // 计算对比度
      const contrast = bgColor.contrast(textColor)
      const bgLuminance = bgColor.getLuminance()
      const textLuminance = textColor.getLuminance()

      // 更新对比度信息
      document.getElementById('contrastRatio').textContent = contrast.toFixed(2)
      document.getElementById('contrastRatio').className = 'result-value ' + (contrast >= 4.5 ? 'pass' : 'fail')
      document.getElementById('textLuminance').textContent = textLuminance.toFixed(3)
      document.getElementById('bgLuminance').textContent = bgLuminance.toFixed(3)

      // WCAG 等级检查
      const levels = [
        {
          name: 'AA 正常文本',
          required: 4.5,
          pass: contrast >= 4.5,
          desc: '18px 或 14px 粗体以下'
        },
        {
          name: 'AA 大号文本',
          required: 3.0,
          pass: contrast >= 3.0,
          desc: '18px 或 14px 粗体以上'
        },
        {
          name: 'AAA 正常文本',
          required: 7.0,
          pass: contrast >= 7.0,
          desc: '最高标准'
        },
        {
          name: 'AAA 大号文本',
          required: 4.5,
          pass: contrast >= 4.5,
          desc: '大文本最高标准'
        }
      ]

      const wcagLevelsContainer = document.getElementById('wcagLevels')
      wcagLevelsContainer.innerHTML = levels.map(level => \`
        <div class="wcag-level \${level.pass ? 'pass' : 'fail'}">
          <div class="wcag-level-name">\${level.name}</div>
          <div class="wcag-level-status">\${level.pass ? '✓ 通过' : '✗ 未通过'}</div>
          <div class="wcag-level-desc">\${level.desc}</div>
          <div class="wcag-level-desc">需要: \${level.required}:1</div>
        </div>
      \`).join('')

      // 生成建议
      const suggestions = []
      
      if (contrast < 4.5) {
        suggestions.push({
          title: '对比度不足',
          desc: \`当前对比度 \${contrast.toFixed(2)}:1，建议至少达到 4.5:1 以符合 WCAG AA 标准。\`
        })

        // 提供调整建议
        if (textColor.isLight()) {
          suggestions.push({
            title: '调整文本颜色',
            desc: '尝试使文本颜色更深，或者调整背景为更浅的颜色。'
          })
        } else {
          suggestions.push({
            title: '调整背景颜色',
            desc: '尝试使背景颜色更浅，或者调整文本为更深的颜色。'
          })
        }
      } else if (contrast >= 4.5 && contrast < 7.0) {
        suggestions.push({
          title: '符合 AA 标准',
          desc: '当前对比度符合 WCAG AA 标准，适用于大多数情况。如需达到 AAA 标准，需要至少 7:1 的对比度。'
        })
      } else {
        suggestions.push({
          title: '优秀的对比度',
          desc: '当前对比度符合 WCAG AAA 最高标准，具有极佳的可读性！'
        })
      }

      const suggestionsContainer = document.getElementById('suggestions')
      suggestionsContainer.innerHTML = \`
        <div class="results-title">建议</div>
        \${suggestions.map(s => \`
          <div class="suggestion-item">
            <strong>\${s.title}</strong>
            <div style="margin-top: 5px; color: #666;">\${s.desc}</div>
          </div>
        \`).join('')}
      \`
    }

    // 事件监听
    bgColorInput.addEventListener('input', (e) => {
      bgHexInput.value = e.target.value
      updateAccessibility()
    })

    textColorInput.addEventListener('input', (e) => {
      textHexInput.value = e.target.value
      updateAccessibility()
    })

    bgHexInput.addEventListener('input', (e) => {
      try {
        const color = new Color(e.target.value)
        bgColorInput.value = color.toHex()
        updateAccessibility()
      } catch (e) {}
    })

    textHexInput.addEventListener('input', (e) => {
      try {
        const color = new Color(e.target.value)
        textColorInput.value = color.toHex()
        updateAccessibility()
      } catch (e) {}
    })

    // 初始化
    updateAccessibility()
  </script>
</body>

</html>
